<!DOCTYPE html>


































































<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>Using Text-to-Speech | Android Developers</title>
<link href="../../assets/android-developer-docs-devguide.css" rel="stylesheet" type="text/css" />
<script src="../../assets/search_autocomplete.js" type="text/javascript"></script>
<script src="../../assets/jquery-resizable.min.js" type="text/javascript"></script>
<script src="../../assets/android-developer-docs.js" type="text/javascript"></script>
<script src="../../assets/prettify.js" type="text/javascript"></script>
<script type="text/javascript">
  setToRoot("../../");
</script>
<script src="../../resources/resources-data.js" type="text/javascript"></script>
<noscript>
  <style type="text/css">
    html,body{overflow:auto;}
    #body-content{position:relative; top:0;}
    #doc-content{overflow:visible;border-left:3px solid #666;}
    #side-nav{padding:0;}
    #side-nav .toggle-list ul {display:block;}
    #resize-packages-nav{border-bottom:3px solid #666;}
  </style>
</noscript>
</head>
<body class="gc-documentation" itemscope itemtype="http://schema.org/Article">

  <div id="header">
      <div id="headerLeft">
          <a href="../../index.html" tabindex="-1"><img
              src="../../assets/images/bg_logo.png" alt="Android Developers" /></a>
          <ul id="header-tabs" class="resources">
    
	<li id="home-link"><a href="../../offline.html">
	
		<span class="en">Home</span>
		<span style="display:none" class="de">Startseite</span>
		<span style="display:none" class="es"></span>
		<span style="display:none" class="fr"></span>
		<span style="display:none" class="it"></span>
		<span style="display:none" class="ja">ホーム</span>
		<span style="display:none" class="zh-CN">主页</span>
		<span style="display:none" class="zh-TW">首頁</span>
	
	</a></li>
	<li id="sdk-link"><a href="../../sdk/index.html">
		<span class="en">SDK</span>
	</a></li>
	<li id="guide-link"><a href="../../guide/index.html" onClick="return loadLast('guide')">
	
		<span class="en">Dev Guide</span>
		<span style="display:none" class="de">Handbuch</span>
		<span style="display:none" class="es">Guía</span>
		<span style="display:none" class="fr">Guide</span>
		<span style="display:none" class="it">Guida</span>
		<span style="display:none" class="ja">開発ガイド</span>
		<span style="display:none" class="zh-CN">开发人员指南</span>
		<span style="display:none" class="zh-TW">開發指南</span>
	
	</a></li>
	<li id="reference-link"><a href="../../reference/packages.html" onClick="return loadLast('reference')">
	
		<span class="en">Reference</span>
		<span style="display:none" class="de">Referenz</span>
		<span style="display:none" class="es">Referencia</span>
		<span style="display:none" class="fr">Référence</span>
		<span style="display:none" class="it">Riferimento</span>
		<span style="display:none" class="ja">リファレンス</span>
		<span style="display:none" class="zh-CN">参考</span>
		<span style="display:none" class="zh-TW">參考資料</span>
	
	</a></li>
	<li id="resources-link"><a href="../../resources/index.html" onClick="return loadLast('resources')">
	
		<span class="en">Resources</span>
		<span style="display:none" class="de"></span>
		<span style="display:none" class="es"></span>
		<span style="display:none" class="fr"></span>
		<span style="display:none" class="it"></span>
    		<span style="display:none" class="ja"></span>
		<span style="display:none" class="zh-CN"></span>
		<span style="display:none" class="zh-TW"></span>
	
	</a></li>
	<li id="videos-link"><a href="../../videos/index.html" onClick="return loadLast('videos')">
	
		<span class="en">Videos</span>
		<span style="display:none" class="de"></span>
		<span style="display:none" class="es"></span>
		<span style="display:none" class="fr"></span>
		<span style="display:none" class="it"></span>
		<span style="display:none" class="ja">ビデオ</span>
		<span style="display:none" class="zh-CN"></span>
		<span style="display:none" class="zh-TW"></span>
	
	</a></li>
	<li><a href="http://android-developers.blogspot.com" onClick="return requestAppendHL(this.href)">
	
		<span class="en">Blog</span>
		<span style="display:none" class="de"></span>
		<span style="display:none" class="es"></span>
		<span style="display:none" class="fr"></span>
		<span style="display:none" class="it"></span>
		<span style="display:none" class="ja">ブログ</span>
		<span style="display:none" class="zh-CN">博客</span>
		<span style="display:none" class="zh-TW">網誌</span>
	
	</a></li>


     
</ul>
     
      </div>
      <div id="headerRight">
          <div id="headerLinks">
          &nbsp;&nbsp;
          <a href="../../design/index.html">Android Design</a>&nbsp;&nbsp;
          <a href="http://www.android.com">Android.com</a>
          </div>
  <div id="search" >
      <div id="searchForm">
          <form accept-charset="utf-8" class="gsc-search-box" 
                onsubmit="return submit_search()">
            <table class="gsc-search-box" cellpadding="0" cellspacing="0"><tbody>
                <tr>
                  <td class="gsc-input">
                    <input id="search_autocomplete" class="gsc-input" type="text" size="33" autocomplete="off"
                      title="search developer docs" name="q"
                      value="search developer docs"
                      onFocus="search_focus_changed(this, true)"
                      onBlur="search_focus_changed(this, false)"
                      onkeydown="return search_changed(event, true, '../../')"
                      onkeyup="return search_changed(event, false, '../../')" />
                  <div id="search_filtered_div" class="no-display">
                      <table id="search_filtered" cellspacing=0>
                      </table>
                  </div>
                  </td>
                  <td class="gsc-search-button">
                    <input type="submit" value="Search" title="search" id="search-button" class="gsc-search-button" />
                  </td>
                  <td class="gsc-clear-button">
                    <div title="clear results" class="gsc-clear-button">&nbsp;</div>
                  </td>
                </tr></tbody>
              </table>
          </form>
      </div><!-- searchForm -->
  </div><!-- search -->
      </div><!-- headerRight -->
      <script type="text/javascript">
        <!--  
        changeTabLang(getLangPref());
        //-->
      </script>
  </div><!-- header -->

  <div class="g-section g-tpl-200" id="body-content">
    <div class="g-unit g-first" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav"><ul>
  <li>
    <span class="heading">
      <span class="en">Android Training</span>
    </span>
    <ul>
      
      <li><a href="../../training/index.html">
            <span class="en">Orientation</span>
          </a>
      </li>

      <li class="toggle-list">
        <div><a href="../../training/multiscreen/index.html">
            <span class="en">Designing for Multiple Screens</span>
          </a></div>
        <ul>
          <li><a href="../../training/multiscreen/screensizes.html">
            <span class="en">Supporting Different Screen Sizes</span>
          </a>
          </li>
          <li><a href="../../training/multiscreen/screendensities.html">
            <span class="en">Supporting Different Screen Densities</span>
          </a>
          </li>
          <li><a href="../../training/multiscreen/adaptui.html">
            <span class="en">Implementing Adaptive UI Flows</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/improving-layouts/index.html">
            <span class="en">Improving Layout Performance</span>
          </a></div>
        <ul>
          <li><a href="../../training/improving-layouts/optimizing-layout.html">
            <span class="en">Optimizing Layout Hierarchies</span>
          </a>
          </li>
          <li><a href="../../training/improving-layouts/reusing-layouts.html">
            <span class="en">Re-using Layouts with &lt;include/&gt;</span>
          </a>
          </li>
          <li><a href="../../training/improving-layouts/loading-ondemand.html">
            <span class="en">Loading Views On Demand</span>
          </a>
          </li>
          <li><a href="../../training/improving-layouts/smooth-scrolling.html">
            <span class="en">Making ListView Scrolling Smooth</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/managing-audio/index.html">
            <span class="en">Managing Audio Playback</span>
          </a></div>
        <ul>
          <li><a href="../../training/managing-audio/volume-playback.html">
            <span class="en">Controlling Your App’s Volume and Playback</span>
          </a>
          </li>
          <li><a href="../../training/managing-audio/audio-focus.html">
            <span class="en">Managing Audio Focus</span>
          </a>
          </li>
          <li><a href="../../training/managing-audio/audio-output.html">
            <span class="en">Dealing with Audio Output Hardware</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/monitoring-device-state/index.html">
            <span class="en">Optimizing Battery Life</span>
          </a></div>
        <ul>
          <li><a href="../../training/monitoring-device-state/battery-monitoring.html">
            <span class="en">Monitoring the Battery Level and Charging State</span>
          </a>
          </li>
          <li><a href="../../training/monitoring-device-state/docking-monitoring.html">
            <span class="en">Determining and Monitoring the Docking State and Type</span>
          </a>
          </li>
          <li><a href="../../training/monitoring-device-state/connectivity-monitoring.html">
            <span class="en">Determining and Monitoring the Connectivity Status</span>
          </a>
          </li>
          <li><a href="../../training/monitoring-device-state/manifest-receivers.html">
            <span class="en">Manipulating Broadcast Receivers On Demand</span>
          </a>
          </li>
        </ul>
      </li>

      <li class="toggle-list">
        <div><a href="../../training/search/index.html">
            <span class="en">Adding Search Functionality</span>
          </a> <span class="new">new!</span>
        </div>
        <ul>
          <li><a href="../../training/search/setup.html">
            <span class="en">Setting up the Search Interface</span>
          </a>
          </li>
          <li><a href="../../training/search/search.html">
            <span class="en">Storing and Searching for Data</span>
          </a>
          </li>
          <li><a href="../../training/search/backward-compat.html">
            <span class="en">Remaining Backward Compatible</span>
          </a>
          </li>
        </ul>
      </li>

      <li class="toggle-list">
        <div><a href="../../training/id-auth/index.html">
            <span class="en">Remembering Users</span>
          </a></div>
        <ul>
          <li><a href="../../training/id-auth/identify.html">
            <span class="en">Remembering Your User</span>
          </a>
          </li>
          <li><a href="../../training/id-auth/authenticate.html">
            <span class="en">Authenticating to OAuth2 Services</span>
          </a>
          </li>
          <li><a href="../../training/id-auth/custom_auth.html">
            <span class="en">Creating a Custom Account Type</span>
          </a>
          </li>
        </ul>
      </li>

      <li class="toggle-list">
        <div><a href="../../training/sharing/index.html">
            <span class="en">Sharing Content</span>
          </a></div>
        <ul>
          <li><a href="../../training/sharing/send.html">
            <span class="en">Sending Content to Other Apps</span>
          </a>
          </li>
          <li><a href="../../training/sharing/receive.html">
            <span class="en">Receiving Content from Other Apps</span>
          </a>
          </li>
          <li><a href="../../training/sharing/shareaction.html">
            <span class="en">Adding an Easy Share Action</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/camera/index.html">
            <span class="en">Capturing Photos</span>
          </a></div>
        <ul>
          <li><a href="../../training/camera/photobasics.html">
            <span class="en">Taking Photos Simply</span>
          </a>
          </li>
          <li><a href="../../training/camera/videobasics.html">
            <span class="en">Recording Videos Simply</span>
          </a>
          </li>
          <li><a href="../../training/camera/cameradirect.html">
            <span class="en">Controlling the Camera</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/multiple-apks/index.html">
            <span class="en">Maintaining Multiple APKs</span>
          </a></div>
        <ul>
          <li><a href="../../training/multiple-apks/api.html">
            <span class="en">Creating Multiple APKs for Different API Levels</span>
          </a>
          </li>
          <li><a href="../../training/multiple-apks/screensize.html">
            <span class="en">Creating Multiple APKs for Different Screen Sizes</span>
          </a>
          </li>
          <li><a href="../../training/multiple-apks/texture.html">
            <span class="en">Creating Multiple APKs for Different GL Textures</span>
          </a>
          </li>
          <li><a href="../../training/multiple-apks/multiple.html">
            <span class="en">Creating Multiple APKs with 2+ Dimensions</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/enterprise/index.html">
            <span class="en">Developing for Enterprise</span>
          </a></div>
        <ul>
          <li><a href="../../training/enterprise/device-management-policy.html">
            <span class="en">Enhancing Security with Device Management Policies</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/monetization/index.html">
            <span class="en">Monetizing Your App</span>
          </a></div>
        <ul>
          <li><a href="../../training/monetization/ads-and-ux.html">
            <span class="en">Advertising without Compromising User Experience</span>
          </a>
          </li>
        </ul>
      </li>
      
      <li class="toggle-list">
        <div><a href="../../training/design-navigation/index.html">
            <span class="en">Designing Effective Navigation</span>
          </a></div>
        <ul>
          <li><a href="../../training/design-navigation/screen-planning.html">
            <span class="en">Planning Screens and Their Relationships</span>
          </a>
          </li>
          <li><a href="../../training/design-navigation/multiple-sizes.html">
            <span class="en">Planning for Multiple Touchscreen Sizes</span>
          </a>
          </li>
          <li><a href="../../training/design-navigation/descendant-lateral.html">
            <span class="en">Providing Descendant and Lateral Navigation</span>
          </a>
          </li>
          <li><a href="../../training/design-navigation/ancestral-temporal.html">
            <span class="en">Providing Ancestral and Temporal Navigation</span>
          </a>
          </li>
          <li><a href="../../training/design-navigation/wireframing.html">
            <span class="en">Putting it All Together: Wireframing the Example App</span>
          </a>
          </li>
        </ul>
      </li>
    </ul>
  </li>    
      
      
  <li>
    <span class="heading">
      <span class="en">Technical Resources</span>
    </span>
    <ul>
      <li class="toggle-list">
        <div><a href="../../resources/browser.html?tag=sample">
            <span class="en">Sample Code</span>
            <span class="de" style="display:none">Beispielcode</span>
            <span class="es" style="display:none">Código de ejemplo</span>
            <span class="fr" style="display:none">Exemple de code</span>
            <span class="it" style="display:none">Codice di esempio</span>
            <span class="ja" style="display:none">サンプル コード</span>
            <span class="zh-CN" style="display:none"></span>
            <span class="zh-TW" style="display:none"></span>
          </a></div>
        <ul id="devdoc-nav-sample-list">
          <li><a href="../../resources/samples/get.html">
                <span class="en">Getting the Samples</span>
              </a></li>
        </ul>
      </li>
      <li class="toggle-list">
        <div><a href="../../resources/browser.html?tag=article">
               <span class="en">Articles</span>
             </a></div>
        <ul id="devdoc-nav-article-list">
        </ul>
      </li>
      <li class="toggle-list">
        <div><a href="../../resources/browser.html?tag=tutorial">
               <span class="en">Tutorials</span>
               <span class="de" style="display:none">Lernprogramme</span>
               <span class="es" style="display:none">Tutoriales</span>
               <span class="fr" style="display:none">Didacticiels</span>
               <span class="it" style="display:none">Esercitazioni</span>
               <span class="ja" style="display:none">チュートリアル</span>
               <span class="zh-CN" style="display:none"></span>
               <span class="zh-TW" style="display:none"></span>
             </a></div>
        <ul id="devdoc-nav-tutorial-list">
        </ul>
      </li>
      <li class="toggle-list">
        <div><a href="../../resources/topics.html">
               <span class="en">Topics</span>
             </a></div>
        <ul id="devdoc-nav-topic-list">
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <span class="heading">
      <span class="en">Community</span>
      <span style="display:none" class="de"></span>
      <span style="display:none" class="es">Comunidad</span>
      <span style="display:none" class="fr">Communauté</span>
      <span style="display:none" class="it"></span>
      <span style="display:none" class="ja">コミュニティ</span>
      <span style="display:none" class="zh-CN">社区</span>
      <span style="display:none" class="zh-TW">社群</span>
    </span>
    <ul>
      <li><a href="../../resources/community-groups.html">
            <span class="en">Developer Forums</span>
          </a></li>
      <li><a href="../../resources/community-more.html">
            <span class="en">IRC, G+, Twitter</span>
          </a></li>
    </ul>
  </li>


  <li>
    <span class="heading">
      <span class="en">More</span>
    </span>
    <ul>
      <li><a href="../../resources/faq/commontasks.html">
            <span class="en">Common Tasks </span>
          </a></li>
      <li><a href="../../resources/faq/troubleshooting.html">
            <span class="en">Troubleshooting Tips</span>
          </a></li>
      <li class="toggle-list">
        <div><a href="../../resources/faq/index.html">
               <span class="en">FAQs</span>
             </a></div>
        <ul>
        <li><a href="../../resources/faq/framework.html">
                <span class="en">App Framework FAQ</span>
                </a></li>
        <li><a href="../../resources/faq/licensingandoss.html">
                <span class="en">Licensing FAQ</span>
                </a></li>
        <li><a href="../../resources/faq/security.html">
                <span class="en">Security FAQ</span>
                </a></li>
        </ul>
     </li>
    </ul>
  </li>
</ul>

<script type="text/javascript">
<!--
    buildToggleLists();
    changeNavLang(getLangPref());
//-->
</script>

      </div>
    </div> <!-- end side-nav -->
    <script>
      addLoadEvent(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="g-unit" id="doc-content"><a name="top"></a>

<div id="jd-header" class="guide-header">
  <span class="crumb" itemprop="breadcrumb">
    
      <a href="../browser.html?tag=article">Articles</a>:
    
  </span>
<h1 itemprop="name">Using Text-to-Speech</h1>
</div>

  
  <div id="jd-content">
 
    


    <div class="jd-descr" itemprop="articleBody">
    <p>Starting with Android 1.6 (API Level 4), the Android platform includes a new
Text-to-Speech (TTS) capability. Also known as "speech synthesis", TTS enables
your Android device to "speak" text of different languages.</p>

<p>Before we explain how to use the TTS API itself, let's first review a few
aspects of the engine that will be important to your TTS-enabled application. We
will then show how to make your Android application talk and how to configure
the way it speaks.</p>

<h3>Languages and resources</h3>

<p>The TTS engine that ships with the Android platform supports a number of
languages: English, French, German, Italian and Spanish. Also, depending on
which side of the Atlantic you are on, American and British accents for English
are both supported.</p>

<p>The TTS engine needs to know which language to speak, as a word like "Paris",
for example, is pronounced differently in French and English. So the voice and
dictionary are language-specific resources that need to be loaded before the
engine can start to speak.</p>

<p>Although all Android-powered devices that support the TTS functionality ship
with the engine, some devices have limited storage and may lack the
language-specific resource files. If a user wants to install those resources,
the TTS API enables an application to query the platform for the availability of
language files and can initiate their download and installation. So upon
creating your activity, a good first step is to check for the presence of the
TTS resources with the corresponding intent:</p>

<pre>Intent checkIntent = new Intent();
checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
startActivityForResult(checkIntent, MY_DATA_CHECK_CODE);</pre>

<p>A successful check will be marked by a <code>CHECK_VOICE_DATA_PASS</code>
result code, indicating this device is ready to speak, after the creation of
our 
<code><a href="../../reference/android/speech/tts/TextToSpeech.html">TextToSpeech</a></code> object. If not, we need to let the user
know to install the data that's required for the device to become a
multi-lingual talking machine! Downloading and installing the data is
accomplished by firing off the ACTION_INSTALL_TTS_DATA intent, which will take
the user to Google Play, and will let her/him initiate the download.
Installation of the data will happen automatically once the download completes.
Here is an example of what your implementation of
<code>onActivityResult()</code> would look like:</p>

<pre>private TextToSpeech mTts;
protected void onActivityResult(
        int requestCode, int resultCode, Intent data) {
    if (requestCode == MY_DATA_CHECK_CODE) {
        if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
            // success, create the TTS instance
            mTts = new TextToSpeech(this, this);
        } else {
            // missing data, install it
            Intent installIntent = new Intent();
            installIntent.setAction(
                TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
            startActivity(installIntent);
        }
    }
}</pre>

<p>In the constructor of the <code>TextToSpeech</code> instance we pass a
reference to the <code>Context</code> to be used (here the current Activity),
and to an <code>OnInitListener</code> (here our Activity as well). This listener
enables our application to be notified when the Text-To-Speech engine is fully
loaded, so we can start configuring it and using it.</p>

<h4>Languages and Locale</h4>

<p>At Google I/O 2009, we showed an <a title="Google I/O 2009, TTS
demonstration" href="http://www.youtube.com/watch?v=uX9nt8Cpdqg#t=6m17s"
id="rnfd">example of TTS</a> where it was used to speak the result of a
translation from and to one of the 5 languages the Android TTS engine currently
supports. Loading a language is as simple as calling for instance:</p>

<pre>mTts.setLanguage(Locale.US);</pre><p>to load and set the language to
English, as spoken in the country "US". A locale is the preferred way to specify
a language because it accounts for the fact that the same language can vary from
one country to another. To query whether a specific Locale is supported, you can
use <code>isLanguageAvailable()</code>, which returns the level of support for
the given Locale. For instance the calls:</p>

<pre>mTts.isLanguageAvailable(Locale.UK))
mTts.isLanguageAvailable(Locale.FRANCE))
mTts.isLanguageAvailable(new Locale("spa", "ESP")))</pre>

<p>will return TextToSpeech.LANG_COUNTRY_AVAILABLE to indicate that the language
AND country as described by the Locale parameter are supported (and the data is
correctly installed). But the calls:</p>

<pre>mTts.isLanguageAvailable(Locale.CANADA_FRENCH))
mTts.isLanguageAvailable(new Locale("spa"))</pre>

<p>will return <code>TextToSpeech.LANG_AVAILABLE</code>. In the first example,
French is supported, but not the given country. And in the second, only the
language was specified for the Locale, so that's what the match was made on.</p>

<p>Also note that besides the <code>ACTION_CHECK_TTS_DATA</code> intent to check
the availability of the TTS data, you can also use
<code>isLanguageAvailable()</code> once you have created your
<code>TextToSpeech</code> instance, which will return
<code>TextToSpeech.LANG_MISSING_DATA</code> if the required resources are not
installed for the queried language.</p>

<p>Making the engine speak an Italian string while the engine is set to the
French language will produce some pretty <i>interesting </i>results, but it will
not exactly be something your user would understand  So try to match the
language of your application's content and the language that you loaded in your
<code>TextToSpeech</code> instance. Also if you are using
<code>Locale.getDefault()</code> to query the current Locale, make sure that at
least the default language is supported.</p>

<h3>Making your application speak</h3>

<p>Now that our <code>TextToSpeech</code> instance is properly initialized and
configured, we can start to make your application speak. The simplest way to do
so is to use the <code>speak()</code> method. Let's iterate on the following
example to make a talking alarm clock:</p>

<pre>String myText1 = "Did you sleep well?";
String myText2 = "I hope so, because it's time to wake up.";
mTts.speak(myText1, TextToSpeech.QUEUE_FLUSH, null);
mTts.speak(myText2, TextToSpeech.QUEUE_ADD, null);</pre>

<p>The TTS engine manages a global queue of all the entries to synthesize, which
are also known as "utterances". Each <code>TextToSpeech</code> instance can
manage its own queue in order to control which utterance will interrupt the
current one and which one is simply queued. Here the first <code>speak()</code>
request would interrupt whatever was currently being synthesized: the queue is
flushed and the new utterance is queued, which places it at the head of the
queue. The second utterance is queued and will be played after
<code>myText1</code> has completed.</p>

<h4>Using optional parameters to change the playback stream type</h4>

<p>On Android, each audio stream that is played is associated with one stream
type, as defined in 
<code><a href="../../reference/android/media/AudioManager.html">android.media.AudioManager</a></code>. For a talking 
alarm clock, we would like our text to be played on the
<code>AudioManager.STREAM_ALARM</code> stream type so that it respects the alarm
settings the user has chosen on the device. The last parameter of the speak()
method allows you to pass to the TTS engine optional parameters, specified as
key/value pairs in a HashMap. Let's use that mechanism to change the stream type
of our utterances:</p>

<pre>HashMap&lt;String, String&gt; myHashAlarm = new HashMap();
myHashAlarm.put(TextToSpeech.Engine.KEY_PARAM_STREAM,
        String.valueOf(AudioManager.STREAM_ALARM));
mTts.speak(myText1, TextToSpeech.QUEUE_FLUSH, myHashAlarm);
mTts.speak(myText2, TextToSpeech.QUEUE_ADD, myHashAlarm);</pre>

<h4>Using optional parameters for playback completion callbacks</h4>

<p>Note that <code>speak()</code> calls are asynchronous, so they will return
well before the text is done being synthesized and played by Android, regardless
of the use of <code>QUEUE_FLUSH</code> or <code>QUEUE_ADD</code>. But you might
need to know when a particular utterance is done playing. For instance you might
want to start playing an annoying music after <code>myText2</code> has finished
synthesizing (remember, we're trying to wake up the user). We will again use an
optional parameter, this time to tag our utterance as one we want to identify.
We also need to make sure our activity implements the
<code>TextToSpeech.OnUtteranceCompletedListener</code> interface:</p>

<pre>mTts.setOnUtteranceCompletedListener(this);
myHashAlarm.put(TextToSpeech.Engine.KEY_PARAM_STREAM,
        String.valueOf(AudioManager.STREAM_ALARM));
mTts.speak(myText1, TextToSpeech.QUEUE_FLUSH, myHashAlarm);
myHashAlarm.put(TextToSpeech.Engine.KEY_PARAM_UTTERANCE_ID,
        "end of wakeup message ID");
// myHashAlarm now contains two optional parameters
mTts.speak(myText2, TextToSpeech.QUEUE_ADD, myHashAlarm);</pre>

<p>And the Activity gets notified of the completion in the implementation 
of the listener:</p>

<pre>public void onUtteranceCompleted(String uttId) {
    if (uttId == "end of wakeup message ID") {
        playAnnoyingMusic();
    } 
}</pre>

<h4>File rendering and playback</h4>

<p>While the <code>speak()</code> method is used to make Android speak the text
right away, there are cases where you would want the result of the synthesis to
be recorded in an audio file instead. This would be the case if, for instance,
there is text your application will speak often; you could avoid the synthesis
CPU-overhead by rendering only once to a file, and then playing back that audio
file whenever needed. Just like for <code>speak()</code>, you can use an
optional utterance identifier to be notified on the completion of the synthesis
to the file:</p>

<pre>HashMap&lt;String, String&gt; myHashRender = new HashMap();
String wakeUpText = "Are you up yet?";
String destFileName = "/sdcard/myAppCache/wakeUp.wav";
myHashRender.put(TextToSpeech.Engine.KEY_PARAM_UTTERANCE_ID, wakeUpText);
mTts.synthesizeToFile(wakuUpText, myHashRender, destFileName);</pre>

<p>Once you are notified of the synthesis completion, you can play the output
file just like any other audio resource with 
<code><a href="../../reference/android/media/MediaPlayer.html">android.media.MediaPlayer</a></code>.</p>

<p>But the <code>TextToSpeech</code> class offers other ways of associating
audio resources with speech. So at this point we have a WAV file that contains
the result of the synthesis of "Wake up" in the previously selected language. We
can tell our TTS instance to associate the contents of the string "Wake up" with
an audio resource, which can be accessed through its path, or through the
package it's in, and its resource ID, using one of the two
<code>addSpeech()</code> methods:</p>

<pre>mTts.addSpeech(wakeUpText, destFileName);</pre>

<p>This way any call to speak() for the same string content as
<code>wakeUpText</code> will result in the playback of
<code>destFileName</code>. If the file is missing, then speak will behave as if
the audio file wasn't there, and will synthesize and play the given string. But
you can also take advantage of that feature to provide an option to the user to
customize how "Wake up" sounds, by recording their own version if they choose
to. Regardless of where that audio file comes from, you can still use the same
line in your Activity code to ask repeatedly "Are you up yet?":</p>

<pre>mTts.speak(wakeUpText, TextToSpeech.QUEUE_ADD, myHashAlarm);</pre>

<h4>When not in use...</h4><p>The text-to-speech functionality relies on a
dedicated service shared across all applications that use that feature. When you
are done using TTS, be a good citizen and tell it "you won't be needing its
services anymore" by calling <code>mTts.shutdown()</code>, in your Activity
<code>onDestroy()</code> method for instance.</p>

<h3>Conclusion</h3>

<p>Android now talks, and so can your apps. Remember that in order for
synthesized speech to be intelligible, you need to match the language you select
to that of the text to synthesize. Text-to-speech can help you push your app in
new directions. Whether you use TTS to help users with disabilities, to enable
the  use of your application while looking away from the screen, or simply to
make it cool, we hope you'll enjoy this new feature.</p>
    </div>

    
    
    <a href="#top" style="float:right">&uarr; Go to top</a>
    
      <p><a href="../browser.html?tag=article">&larr; Back to Articles</a></p>
    

  </div> <!-- end jd-content -->

<div id="footer">


  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../license.html">Content 
  License</a>.
  </div>

  <div id="footerlinks">
    
  <p>
    <a href="http://www.google.com/intl/en/policies/" target="_blank">Privacy &amp; Terms</a> -
    <a href="http://www.android.com/branding.html" target="_blank">Brand Guidelines</a> -
    <a
href="http://code.google.com/p/android/issues/entry?template=Developer%20Documentation"
target="_blank">Report Document Issues</a>
  </p>
  </div>

</div> <!-- end footer -->

</div><!-- end doc-content -->

</div> <!-- end body-content --> 

<script type="text/javascript">
init(); /* initialize android-developer-docs.js */
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5831155-1");
pageTracker._trackPageview();
</script>

</body>
</html>



